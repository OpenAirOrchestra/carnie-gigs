(this.webpackJsonptake_attendance=this.webpackJsonptake_attendance||[]).push([[0],{18:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(13),s=n.n(a),c=(n(18),n(1)),i=n.n(c),o=n(5),u=n(4),l=n(3),d=n(8),p=n(9),h={attendanceService:null,eventService:null,userService:null,pluginName:null},f=n(6),j=n(7),b=function(){function e(){Object(f.a)(this,e),this.deleteUnsupported=!1}return Object(j.a)(e,[{key:"serviceLocation",value:function(){return"../../../../?rest_route=/"+h.pluginName+"/v1/attendees"}},{key:"restNonce",value:function(){var e=window.location.search;return new URLSearchParams(e).get("_wpnonce")}},{key:"retrieve",value:function(){var e=Object(l.a)(i.a.mark((function e(t,n,r){var a,s,c,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({page:t,per_page:n,_wpnonce:this.restNonce()}),r&&a.set("search",r),s=this.serviceLocation()+"&"+a.toString(),e.next=5,fetch(s);case 5:if((c=e.sent).ok){e.next=13;break}return console.log("Failed url fetch: "+c.status+" "+c.statusText),e.next=10,c.text();case 10:throw o=e.sent,console.log("Response text: "+o),new Error("Failed to get attendees Response: "+c.status+" "+c.statusText);case 13:return e.abrupt("return",c.json());case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({_wpnonce:this.restNonce()}),r=this.serviceLocation()+"/"+t+"&"+n.toString(),e.next=4,fetch(r);case 4:if((a=e.sent).ok){e.next=12;break}return console.log("Failed url fetch: "+a.status+" "+a.statusText),e.next=9,a.text();case 9:throw s=e.sent,console.log("Response text: "+s),new Error("Failed to get attendee Response: "+a.status+" "+a.statusText);case 12:return e.abrupt("return",a.json());case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({_wpnonce:this.restNonce()}),r=this.serviceLocation()+"&"+n.toString(),e.next=4,fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if((a=e.sent).ok){e.next=12;break}return console.log("Failed url fetch: "+a.status+" "+a.statusText),e.next=9,a.text();case 9:throw s=e.sent,console.log("Response text: "+s),new Error("Failed to create attendance record Response: "+a.status+" "+a.statusText);case 12:return e.abrupt("return",a.json());case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,s,c,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=null,this.deleteUnsupported){e.next=9;break}return a=new URLSearchParams({_wpnonce:this.restNonce()}),s=this.serviceLocation()+"/"+n+"&"+a.toString(),e.next=7,fetch(s,{method:"DELETE",mode:"cors"});case 7:(r=e.sent).ok||(this.deleteUnsupported=!0);case 9:if(!this.deleteUnsupported){e.next=15;break}return c=new URLSearchParams({method:"DELETE",_wpnonce:this.restNonce()}),o=this.serviceLocation()+"/"+n+"&"+c.toString(),e.next=14,fetch(o,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 14:r=e.sent;case 15:if(r.ok){e.next=22;break}return console.log("Failed url fetch: "+r.status+" "+r.statusText),e.next=19,r.text();case 19:throw u=e.sent,console.log("Response text: "+u),new Error("Failed to delete attendee Response: "+r.status+" "+r.statusText);case 22:return e.abrupt("return",Promise.resolve(r));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),v=b,x=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,[{key:"serviceLocation",value:function(){return"../../../../?rest_route=/"+h.pluginName+"/v1/events"}},{key:"restNonce",value:function(){var e=window.location.search;return new URLSearchParams(e).get("_wpnonce")}},{key:"retrieve",value:function(){var e=Object(l.a)(i.a.mark((function e(t,n,r){var a,s,c,o,u,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new URLSearchParams({page:t,per_page:n,_wpnonce:this.restNonce()}),r&&(s=r.getTimezoneOffset(),c=new Date(r.getTime()-60*s*1e3),o=c.toISOString().substring(0,10),a.set("search",o)),u=this.serviceLocation()+"&"+a.toString(),e.next=5,fetch(u);case 5:if((l=e.sent).ok){e.next=13;break}return console.log("Failed url fetch: "+l.status+" "+l.statusText),e.next=10,l.text();case 10:throw d=e.sent,console.log("Response text: "+d),new Error("Failed to get workshops Response: "+l.status+" "+l.statusText);case 13:return e.abrupt("return",l.json());case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({_wpnonce:this.restNonce()}),r=this.serviceLocation()+"/"+t+"&"+n.toString(),e.next=4,fetch(r);case 4:if((a=e.sent).ok){e.next=12;break}return console.log("Failed url fetch: "+a.status+" "+a.statusText),e.next=9,a.text();case 9:throw s=e.sent,console.log("Response text: "+s),new Error("Failed to get workshop Response: "+a.status+" "+a.statusText);case 12:return e.abrupt("return",a.json());case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({_wpnonce:this.restNonce()}),r=this.serviceLocation()+"&"+n.toString(),e.next=4,fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if((a=e.sent).ok){e.next=12;break}return console.log("Failed url fetch: "+a.status+" "+a.statusText),e.next=9,a.text();case 9:throw s=e.sent,console.log("Response text: "+s),new Error("Failed to create workshop Response: "+a.status+" "+a.statusText);case 12:return e.abrupt("return",a.json());case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),m=x,O=function(){function e(){Object(f.a)(this,e)}return Object(j.a)(e,[{key:"serviceLocation",value:function(){return"../../../../?rest_route=/"+h.pluginName+"/v1/users"}},{key:"restNonce",value:function(){var e=window.location.search;return new URLSearchParams(e).get("_wpnonce")}},{key:"retrieve",value:function(){var e=Object(l.a)(i.a.mark((function e(t,n){var r,a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URLSearchParams({page:t,per_page:n,_wpnonce:this.restNonce()}),a=this.serviceLocation()+"&"+r.toString(),e.next=4,fetch(a);case 4:if((s=e.sent).ok){e.next=12;break}return console.log("Failed url fetch: "+s.status+" "+s.statusText),e.next=9,s.text();case 9:throw c=e.sent,console.log("Response text: "+c),new Error("Failed to list users Response: "+s.status+" "+s.statusText);case 12:return e.abrupt("return",s.json());case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),g=O,w=n(0),k=function(e){var t=e.name,n=e.url,r=Object(w.jsx)("h1",{children:"Loading..."});t&&(r=Object(w.jsxs)("h1",{children:[">Attendance for ",t]}));n&&t&&(r=Object(w.jsxs)("h1",{children:["Attendance for ",Object(w.jsx)("a",{href:n,children:t})]}));return Object(w.jsx)("div",{className:"Header",children:r})};var S=function(e){var t=e.searchTerm,n=e.setSearchTerm,r=e.filterRecent,a=e.setFilterRecent,s=e.filterOld,c=e.setFilterOld,i=e.filterNew,o=e.setFilterNew,u=e.filterPresent,l=e.setFilterPresent,d=t?Object(w.jsx)("input",{type:"search",name:"search",placeholder:"Search",value:t,onChange:function(e){return n(e.target.value)}}):Object(w.jsx)("input",{type:"search",name:"search",results:"0",placeholder:"Search",value:t,onChange:function(e){return n(e.target.value)}});return Object(w.jsx)("div",{className:"SearchBar",children:Object(w.jsxs)("form",{children:[d,Object(w.jsx)("br",{}),Object(w.jsx)("input",{type:"checkbox",name:"recent",id:"recent",checked:!!r,onChange:function(e){return a(e.target.checked)}}),Object(w.jsx)("label",{htmlFor:"recent",children:"recent"}),Object(w.jsx)("input",{type:"checkbox",name:"old",id:"old",checked:!!s,onChange:function(e){return c(e.target.checked)}}),Object(w.jsx)("label",{htmlFor:"old",children:"rusty"}),Object(w.jsx)("input",{type:"checkbox",name:"new",id:"new",checked:!!i,onChange:function(e){return o(e.target.checked)}}),Object(w.jsx)("label",{htmlFor:"new",children:"new folks"}),Object(w.jsx)("input",{type:"checkbox",name:"attendees",id:"attendees",checked:!!u,onChange:function(e){return l(e.target.checked)}}),Object(w.jsx)("label",{htmlFor:"attendees",children:"attendees"})]})})};var y=function(e){var t=e.attendee,n=e.pendingMap?e.pendingMap:{},r=e.event_id,a=e.addAttendanceRecord,s=e.deleteAttendanceRecord,c=_(t),i=n[c],o=t.event_id&&t.event_id===r,u=!t.notes||t.notes.length<100?t.notes:"".concat(t.notes.substring(0,100),"\u2026"),l=u?Object(w.jsxs)("div",{children:[" ",u," "]}):"",d=t.phone?Object(w.jsxs)("span",{children:[" ",t.phone," "]}):"",p=t.email?Object(w.jsxs)("span",{children:[" ",t.email," "]}):"",f=o?"\u2714":"\u274c",j=o?"present":"absent",b=i?"pending":"",v="workshop_attendance"===h.pluginName,x=Object(w.jsxs)("div",{children:[l,v?p:"",v?d:""]}),m=i?Object(w.jsx)("span",{className:"pending-spinner"}):"",O=t.lastname;return Object(w.jsxs)("tr",{className:"AttendanceRecord  "+j+" "+b,onClick:function(){o&&!i?s(t):i||a(t)},children:[Object(w.jsxs)("td",{className:"attendee",children:[t.firstname+" "+O,Object(w.jsx)("div",{className:"details",children:x})]}),Object(w.jsxs)("td",{className:"presence",children:[m,Object(w.jsx)("span",{className:"presenceIcon",children:f})]})]})};function _(e){var t=e.user_id;return t&&"0"!==t||(t=e.firstname+"."+e.lastname),t.toString()}var N=function(e){var t=e.attendees,n=e.pendingMap?e.pendingMap:{},r=e.event_id,a=e.addAttendanceRecord,s=e.deleteAttendanceRecord,c=t.sort((function(e,t){var n=e.firstname.toLowerCase(),r=t.firstname.toLowerCase();if(n.toLowerCase()>r.toLowerCase())return 1;if(n.toLowerCase()<r.toLowerCase())return-1;var a=e.lastname?e.lastname.toLowerCase():"",s=t.lastname?t.lastname.toLowerCase():"";return a.toLowerCase()>s.toLowerCase()?1:a.toLowerCase()<s.toLowerCase()?-1:0})).map((function(e){return Object(w.jsx)(y,{attendee:e,event_id:r,pendingMap:n,addAttendanceRecord:a,deleteAttendanceRecord:s},_(e))}));return Object(w.jsx)("div",{className:"AttendanceList",children:Object(w.jsx)("table",{children:Object(w.jsx)("tbody",{children:c})})})};var R=function(e){var t=e.hideAttendeeForm,n=e.addAttendanceRecord,a=Object(r.useState)(""),s=Object(u.a)(a,2),c=s[0],i=s[1],o=Object(r.useState)(""),l=Object(u.a)(o,2),d=l[0],p=l[1],f=Object(r.useState)(""),j=Object(u.a)(f,2),b=j[0],v=j[1],x=Object(r.useState)(""),m=Object(u.a)(x,2),O=m[0],g=m[1],k=Object(r.useState)(""),S=Object(u.a)(k,2),y=S[0],_=S[1],N="workshop_attendance"===h.pluginName?Object(w.jsxs)("div",{children:[Object(w.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(w.jsx)("input",{type:"text",name:"email",id:"email",value:b,onChange:function(e){return v(e.target.value)}}),Object(w.jsx)("br",{}),Object(w.jsx)("label",{htmlFor:"phone",children:"Phone:"}),Object(w.jsx)("input",{type:"text",name:"phone",id:"phone",value:O,onChange:function(e){return g(e.target.value)}}),Object(w.jsx)("br",{})]}):Object(w.jsx)("div",{});if(t)return null;return Object(w.jsxs)("div",{className:"NewAttendeeForm",children:[Object(w.jsx)("h2",{children:"Add New Attendee"}),Object(w.jsxs)("form",{action:"",children:[Object(w.jsx)("label",{htmlFor:"firstname",children:"First Name (required):"}),Object(w.jsx)("input",{type:"text",name:"firstname",id:"firstname",className:"required",value:c,onChange:function(e){return i(e.target.value)}}),Object(w.jsx)("br",{}),Object(w.jsx)("label",{htmlFor:"lastname",children:"Last Name (required): "}),Object(w.jsx)("input",{type:"text",name:"lastname",id:"lastname",className:"required",value:d,onChange:function(e){return p(e.target.value)}}),N,Object(w.jsx)("label",{htmlFor:"notes",children:"Notes:"}),Object(w.jsx)("br",{}),Object(w.jsx)("textarea",{name:"notes",id:"notes",value:y,onChange:function(e){return _(e.target.value)}}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{className:"centered",children:Object(w.jsx)("input",{type:"submit",value:"Add",disabled:!(c&&d),onClick:function(){!function(e,t,n,r,a,s,c,i,o,u,l,d){e({firstname:t,lastname:r,email:s,phone:i,notes:u}),n(""),a(""),c(""),o(""),l("")}(n,c,i,d,p,b,v,O,g,y,_)}})})]})]})};var L=function(e){if(!e.isLoading)return null;return Object(w.jsx)("div",{className:"Loading",children:Object(w.jsx)("div",{className:"inner",children:Object(w.jsx)("div",{className:"spinner"})})})};var F=function(e){var t,n=Object(r.useState)(0),a=Object(u.a)(n,2),s=a[0],c=a[1],i=Object(r.useState)(!0),o=Object(u.a)(i,2),l=o[0],f=o[1],j=Object(r.useState)(""),b=Object(u.a)(j,2),v=b[0],x=b[1],m=Object(r.useState)(!1),O=Object(u.a)(m,2),g=O[0],y=O[1],F=Object(r.useState)(!1),T=Object(u.a)(F,2),C=T[0],P=T[1],A=Object(r.useState)(!1),E=Object(u.a)(A,2),U=E[0],D=E[1],M=Object(r.useState)(!1),I=Object(u.a)(M,2),W=I[0],G=I[1],K=Object(r.useState)(null),Q=Object(u.a)(K,2),V=Q[0],X=Q[1],Y=Object(r.useState)([]),Z=Object(u.a)(Y,2),$=Z[0],ee=Z[1],te=Object(r.useState)([]),ne=Object(u.a)(te,2),re=ne[0],ae=ne[1],se=Object(r.useState)(null),ce=Object(u.a)(se,2),ie=ce[0],oe=ce[1],ue=Object(r.useState)([]),le=Object(u.a)(ue,2),de=le[0],pe=le[1],he=Object(r.useState)([]),fe=Object(u.a)(he,2),je=fe[0],be=fe[1],ve=Object(r.useState)(null),xe=Object(u.a)(ve,2),me=xe[0],Oe=xe[1],ge={},we=Object(p.a)(je);try{for(we.s();!(t=we.n()).done;){var ke=t.value,Se=_(ke);ge[Se]=ke}}catch(Le){we.e(Le)}finally{we.f()}Object(r.useEffect)((function(){B()})),Object(r.useEffect)((function(){s||function(e){H.apply(this,arguments)}(c)}),[s]),Object(r.useEffect)((function(){l&&s&&function(e,t,n,r,a,s,c){J.apply(this,arguments)}(s,f,X,ee,ae,oe,pe)}),[l,s]);var ye=function(e,t){var n=t?t.toLowerCase().replace(/\s+/g,""):null,r=e;n&&(r=r.filter((function(e){return Object.values(e).map((function(e){return String(e).toLowerCase()})).join().replace(/\s+/g,"").includes(n)})));return r}(function(e,t,n,r,a){var s,c={},i=Object(p.a)(t);try{for(i.s();!(s=i.n()).done;){var o=s.value,u={user_id:o.id,firstname:"",lastname:""};o.first_name?(u.firstname=o.first_name,o.last_name&&(u.lastname=o.last_name)):o.display_name&&(u.firstname=o.display_name),o.email&&(u.email=o.email),o.description&&(u.notes=o.description),c[_(u)]=u}}catch(Le){i.e(Le)}finally{i.f()}var l,h=Object(p.a)(n);try{for(h.s();!(l=h.n()).done;){var f=l.value;if(f.event_id!==e){var j=_(f),b=c[j];(b=b?Object(d.a)({},b):Object(d.a)({},f)).id=f.id,b.notes||(b.notes=f.notes),b.event_id=f.event_id,c[j]=b}}}catch(Le){h.e(Le)}finally{h.f()}var v,x=Object(p.a)(r);try{for(x.s();!(v=x.n()).done;){var m=v.value,O=_(m),g=c[O];(g=g?Object(d.a)({},g):Object(d.a)({},m)).id=m.id,g.event_id=m.event_id,m.phone&&!g.phone&&(g.phone=m.phone),m.user_id&&!g.user_id&&(g.user_id=m.user_id),m.user_id&&!g.user_id&&(g.user_id=m.user_id),m.firstname&&!g.firstname&&(g.firstname=m.firstname),m.lastname&&!g.lastname&&(g.lastname=m.lastname),m.notes&&!g.notes&&(g.notes=m.notes),c[O]=g}}catch(Le){x.e(Le)}finally{x.f()}var w,k=Object(p.a)(a);try{for(k.s();!(w=k.n()).done;){var S=w.value,y=_(S),N=c[y];N=N?Object(d.a)({},N):Object(d.a)({},S),c[y]=N}}catch(Le){k.e(Le)}finally{k.f()}var R=Object.values(c);return R||[]}(s,$,re,de,je),v),_e=function(e,t,n,r,a,s,c){var i=t;(r||s||a||c)&&(i=i.filter((function(t){if(s&&(!t.user_id||"0"===t.user_id))return!0;if(c&&t.event_id&&t.event_id===e)return!0;if(r||a){var i=_(t),o=n.has(i);if(r&&o)return!0;if(a&&!o)return!0}return!1})));return i}(s,ye,ie,g,C,U,W),Ne=!l&&(U||W||!g),Re=s?"../../../../wp-admin/admin.php?page=workshop&workshop="+s:null;"carnie-gigs"===h.pluginName&&(Re=s?"../../../../?page_id="+s:null);return Object(w.jsxs)("div",{className:"AttendanceSheet",children:[Object(w.jsx)(k,{name:V?V.title:"",url:Re}),Object(w.jsx)(S,{searchTerm:v,setSearchTerm:x,filterRecent:g,setFilterRecent:y,filterOld:C,setFilterOld:P,filterNew:U,setFilterNew:D,filterPresent:W,setFilterPresent:G}),Object(w.jsx)(N,{attendees:_e,event_id:s,pendingMap:ge,addAttendanceRecord:function(e){Oe(q(s,e,me,je,be,pe))},deleteAttendanceRecord:function(e){Oe(function(e,t,n,r,a,s,c){return z.apply(this,arguments)}(s,e,me,je,be,ae,pe))}}),Object(w.jsx)(R,{hideAttendeeForm:!Ne,addAttendanceRecord:function(e){Oe(q(s,e,me,je,be,pe))}}),Object(w.jsx)(L,{isLoading:l})]})};function T(e){window.confirm(e+"\nReload?")&&window.location.reload()}function C(e){var t=e.getHours();return t<12?"Morning":t<17?"Afternoon":t<20?"Evening":"Night"}function P(){return A.apply(this,arguments)}function A(){return(A=Object(l.a)(i.a.mark((function e(){var t,n,r,a,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=h.userService,n=1,r=500,a=[],s=!0;case 5:return e.next=7,t.retrieve(n,r);case 7:c=e.sent,a=[].concat(Object(o.a)(a),Object(o.a)(c)),s=c.length>=r,++n;case 11:if(s){e.next=5;break}case 12:return e.abrupt("return",Promise.resolve(a));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(i.a.mark((function e(t){var n,r,a,s,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=h.attendanceService,r=1,a=100,s=[],c=!0;case 5:return e.next=7,n.retrieve(r,a,t);case 7:u=e.sent,s=[].concat(Object(o.a)(s),Object(o.a)(u)),c=u.length>=a,++r;case 11:if(c){e.next=5;break}case 12:return e.abrupt("return",Promise.resolve(s));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return M.apply(this,arguments)}function M(){return(M=Object(l.a)(i.a.mark((function e(){var t,n,r,a,s,c,u,l,d,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.location.search,n=new URLSearchParams(t),r=n.get("max_recents"),a=r||100,s=h.attendanceService,c=1,u=Math.min(a,100),l=[],d=!0;case 9:return e.next=11,s.retrieve(c,u);case 11:p=e.sent,l=[].concat(Object(o.a)(l),Object(o.a)(p)),d=p.length>=u,++c;case 15:if(d&&l.length<a){e.next=9;break}case 16:return e.abrupt("return",Promise.resolve(l));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(l.a)(i.a.mark((function e(t,n,r,a,s,c,o){var u,l,d,f,j,b,v,x,m,O,g,w,k,S;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u=h.eventService,l=u.get(t),d=P(),f=D(),j=E(t),e.next=8,l;case 8:return b=e.sent,r(b),e.next=12,d;case 12:return v=e.sent,a(v),e.next=16,f;case 16:x=e.sent,s(x),m=new Set,O=Object(p.a)(x);try{for(O.s();!(g=O.n()).done;)w=g.value,k=_(w),m.add(k)}catch(i){O.e(i)}finally{O.f()}return c(m),e.next=24,j;case 24:S=e.sent,o(S),n(!1),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(0),T(e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}function q(e,t,n,r,a,s){return I.apply(this,arguments)}function I(){return(I=Object(l.a)(i.a.mark((function e(t,n,r,a,s,c){var u,l,p,f,j,b,v,x;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u=h.attendanceService,(l=Object(o.a)(a)).push(n),s(l),u.pendingRecords=l,(p=Object(d.a)({},n)).event_id=t,p.id=void 0,e.next=11,u.create(p);case 11:return e.next=13,r;case 13:f=1,j=100,b=[],v=!0;case 17:return e.next=19,u.retrieve(f,j,t);case 19:x=e.sent,b=[].concat(Object(o.a)(b),Object(o.a)(x)),c(b),v=x.length>=j,++f;case 24:if(v){e.next=17;break}case 25:l=Object(o.a)(u.pendingRecords).filter((function(e){return e!==n})),s(l),u.pendingRecords=l,Promise.resolve(n),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),T(e.t0);case 34:case"end":return e.stop()}}),e,null,[[0,31]])})))).apply(this,arguments)}function z(){return(z=Object(l.a)(i.a.mark((function e(t,n,r,a,s,c,u){var l,d,p,f,j,b;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=h.attendanceService,(d=Object(o.a)(a)).push(n),s(d),l.pendingRecords=d,e.next=8,l.delete(n);case 8:return e.next=10,r;case 10:return p=D(),f=E(t),e.next=14,p;case 14:return j=e.sent,c(j),e.next=18,f;case 18:b=e.sent,u(b),d=Object(o.a)(l.pendingRecords).filter((function(e){return e!==n})),s(d),l.pendingRecords=d,Promise.resolve(n),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),T(e.t0);case 29:case"end":return e.stop()}}),e,null,[[0,26]])})))).apply(this,arguments)}function B(){if(h.userService||(h.eventService=new m,h.userService=new g,h.attendanceService=new v),!h.pluginName){var e=window.location.pathname.split("/");h.pluginName=e[e.length-3]}}function H(){return(H=Object(l.a)(i.a.mark((function e(t){var n,r,a,s,c,o,u,l,d,p,f,j,b,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(n=null)||(r=window.location.search,a=new URLSearchParams(r),n=a.get("event_id")),n){e.next=11;break}return B(),s=h.eventService,e.next=9,s.retrieve(1,100,new Date);case 9:1===(c=e.sent).length&&(n=c[0].id);case 11:if(n){e.next=25;break}return B(),o=h.eventService,u=new Date,l=u.getTimezoneOffset(),d=new Date(u.getTime()-60*l*1e3),p=d.toISOString().substring(0,10),f=navigator.languages[0],j=d.toLocaleDateString(f,{weekday:"long"})+" "+C(u)+" Workshop "+d.toLocaleDateString(f,{day:"numeric",month:"long",year:"numeric"}),b={date:p,title:j},e.next=23,o.create(b);case 23:v=e.sent,n=v.id;case 25:return t(n),e.abrupt("return",Promise.resolve(n));case 29:e.prev=29,e.t0=e.catch(0),T(e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}function W(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(F,{})})}s.a.render(Object(w.jsx)(W,{}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.2e561556.chunk.js.map